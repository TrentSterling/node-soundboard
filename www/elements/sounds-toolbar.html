<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="sounds-target-tabs.html">
<dom-module id="sounds-toolbar">
  <style>
    .toolbar {
      background-color: #00bcd4;
      color: #fff;
      display: block;
      height: 64px;
      width: 100%;
      box-shadow: 0px 0px 5px #888888;
    }    
    
    .content {
      float: left;
      display: inline-block;
      height: 100%;
    } 
    
    .right-adjust {
      float: right;
    }
    
    .search-icon {
      box-sizing: border-box;
      width: 50px;
      padding: 5px;
    }
    
    .target-tabs {
      min-width: 270px;
    }
    
    .search-input {
      color: #fff;
      font-family: Roboto;
      font-size: 26px;

      display: inline-block;
      box-sizing: border-box;
      width: 80%;
      background: transparent;
      border: none;
      margin-left: 10px;
    }
    
    .search-input:focus {
      outline: 0;
    }
    
    ::-webkit-input-placeholder {
      color: #fff;
    }

    :-moz-placeholder { /* Firefox 18- */
      color: #fff;  
    } 

    ::-moz-placeholder {  /* Firefox 19+ */
      color: #fff;  
    }

    :-ms-input-placeholder {  
      color: #fff;  
    }

    .title {
      margin-left: 15px;
      display: flex;
      align-items: center;
      justify-content: left;
    }
    
    .title-inner {
      color: #fff;
      font-family: Roboto;
      font-size: 26px;
    }
    
    .logo {
      box-sizing: border-box;
      padding: 5px;
    }
    
    .hide {
      display: none !important;
    }
  </style>
  <template>
    <div class="toolbar">
      <img hidden$="{{search}}" class="logo content" src="/images/soundboard.png"></img>
      <div hidden$="{{search}}" class="title content">
        <span class="title-inner">{{soundboardTitle}}</span>
      </div>
      <iron-icon hidden$="{{search}}" class="search-icon content right-adjust" on-click="onToggleSearch" icon="search"></iron-icon>
      <sounds-target-tabs hidden$="{{search}}" class="target-tabs content right-adjust" on-target-changed="onTargetChanged"></sounds-target-tabs>
      <iron-icon hidden$="{{!search}}" class="search-icon content" on-click="onToggleSearch" icon="search"></iron-icon>
      <input id="filter" hidden$="{{!search}}" class="search-input content" on-keyup="onFilterChanged" placeholder="Filter (RegExp)"></input>
    </div>
    <br>
  </template>
</dom-module>
<script>
  Polymer({

    is: 'sounds-toolbar',
    
    ready: function() {
      var that = this;
      window.onkeydown = function(e) {
        if (e.which === 27 || e.which === 13) {
          that.search = false; 
        } else {
          that.search = true;
          var inFocus = that.$$('#filter') === document.activeElement;
         
          if (!inFocus) {
            that.$$('#filter').focus();
            that.$$('#filter').sendKeys(e.key);
          }       
        }        
      };
    },
    
    properties: {
       soundboardTitle: {
         type: String,
         value: "broadcast"
       },
       search: {
         type: Boolean,
         value: false
       }       
    },
    
    onTargetChanged: function(e) {
      this.fire("target", e.detail.value);
    },
    
    onFilterChanged: function(e) {      
      this.fire("filter", this.$$('#filter').value);
    },
        
    onToggleSearch: function() {
      this.search = !this.search;
    },
    
    visibility: function(hide) {
      return hide?"hide":"";
    }
  });
</script>